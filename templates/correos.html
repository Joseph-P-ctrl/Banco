<!DOCTYPE html>
<html>
<head>
    <title>Correos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
<header>
    <img src="{{ url_for('static', filename='images/logos.jpeg') }}" alt="Imagen" width="150" height="80">
</header>
<nav class="bg-body-tertiary">
    <ul class="nav nav-pills justify-content-center mb-3">
        <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="/basedatos">Base de Datos</a></li>
        <li class="nav-item"><a class="nav-link" href="/asiento">Asientos</a></li>
        <li class="nav-item"><a class="nav-link active" href="/correos">Correos</a></li>
    </ul>
</nav>

<div class="container text-center">
    <h1>Correos</h1>
    <p>Sube el archivo resultante del procesamiento de Asientos (por ejemplo `asientos.xlsx`) para extraer los correos.</p>

    <form method="POST" action="/correos" enctype="multipart/form-data">
        <div class="mb-3">
            <input type="file" class="form-control" name="file" accept="application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" required>
        </div>
        <div class="mb-3">
            <button class="btn btn-primary" type="submit">Procesar</button>
        </div>
    </form>
    <div class="mt-3">
        <form method="POST" action="/correos">
            <input type="hidden" name="use_existing" value="1">
            <button class="btn btn-secondary" type="submit">Procesar archivo de Asientos existente</button>
        </form>
        <p class="small text-muted mt-2">Procesa `files/asientos.xlsx` creado por la acci√≥n en Asientos (si existe).</p>
    </div>

    {% if emails is defined %}
        <div class="card p-3 mt-3">
            <h5>Correos detectados</h5>
            {% if emails %}
                <ul>
                {% for e in emails %}
                    <li>{{ e }}</li>
                {% endfor %}
                </ul>
                <form action="/send_emails" method="POST">
                    <button class="btn btn-success" type="submit">Enviar</button>
                </form>
            {% else %}
                <p>No se detectaron correos en el archivo.</p>
            {% endif %}
        </div>
    {% endif %}

    {% if mensaje_exito %}
        <div class="alert alert-info mt-3">{{ mensaje_exito }}</div>
    {% endif %}
</div>

</body>
</html>